<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="/css/common.css" />
<link rel="stylesheet" href="/css/user.css" />
<title th:text="${product.name}">ì˜ˆì ê¸ˆ ìƒí’ˆ ìƒì„¸</title>
<style>
body {
	font-family: 'Noto Sans KR', sans-serif;
	margin: 0;
}

.container {
	max-width: 1000px;
	margin: 30px auto;
	background: white;
	padding: 30px;
	border-radius: 10px;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.header h1 {
	margin: 0;
	font-size: 1.8rem;
}

.info-box {
	display: flex;
	justify-content: center;
	gap: 80px; /* í•­ëª© ê°„ ê°„ê²© */
	margin: 30px 0;
	text-align: center;
	flex-wrap: wrap;
}

.info-item {
	display: flex;
	flex-direction: column;
	align-items: center;
	min-width: 100px;
}

.info-value {
	font-size: 1.4rem;
	font-weight: bold;
	color: #000; /* ê¸°ë³¸ê°’ ê²€ì • */
}

.info-value.red {
	color: #d9230f; /* ìµœê³ ê¸ˆë¦¬ë§Œ ë¹¨ê°„ìƒ‰ */
}

.info-label {
	font-size: 1rem;
	font-weight: 600;
	color: #000;
	margin-top: 5px;
}

.calc-container {
	background: #fefefe;
	padding: 20px;
	border: 1px solid #ccc;
	border-radius: 10px;
	margin: 40px 0;
}

.btn {
	background: #D7191F;
	color: white;
	border: none;
	padding: 10px 20px;
	margin: 10px;
	border-radius: 5px;
	cursor: pointer;
	transition: background 0.2s ease;
}

.btn:hover {
	background: #b71510;
}

.modal {
	display: none;
	position: fixed;
	z-index: 999;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: rgba(0, 0, 0, 0.5);
}

.modal-content {
	background: white;
	margin: 5% auto;
	padding: 40px;
	border-radius: 10px;
	width: 80%;
	max-width: 700px;
	max-height: 80vh;
	overflow-y: auto;
	line-height: 1.6; /* âœ… ì¤„ê°„ê²© ì¶”ê°€ */
}

.modal-content p {
	margin-bottom: 1rem; /* âœ… ë‹¨ë½ ì‚¬ì´ ì—¬ë°± */
	line-height: 1.6; /* âœ… ì¤„ ê°„ê²©ë„ ìœ ì§€ */
}

.close {
	position: absolute;
	top: 16px;
	right: 20px;
	font-size: 28px;
	font-weight: bold;
	color: #aaa;
	cursor: pointer;
	transition: color 0.2s ease;
	z-index: 10;
}

.close:hover {
	color: #000;
}

/* ì¶”ê°€ ìŠ¤íƒ€ì¼ (í•„ìš” ì‹œ head ì˜ì—­ì— í¬í•¨) */
#detailContent section {
	display: flex;
	min-height: auto; align-items : center;
	justify-content: space-between; /* âœ… ë‚´ë¶€ ìš”ì†Œ ì‚¬ì´ ê°„ê²© í™•ë³´ */
	flex-direction: row;
	max-width: 900px;
	margin: 100px auto; /* âœ… ìƒí•˜ ì—¬ë°± í™•ë³´ */
	padding: 0 20px; /* âœ… ì–‘ìª½ ì—¬ë°± í™•ë³´ */
	box-sizing: border-box;
	align-items: center;
}

#detailContent section.reverse {
	flex-direction: row-reverse;
}

#detailContent section .text-wrap {
	flex: 1;
	padding: 0 20px;
	text-align: left;
}

#detailContent section.reverse .text-wrap {
	text-align: right;
}

#detailContent section h2 {
	font-size: 1.6rem; /* ê¸°ì¡´ 1.4 â†’ ë” í¼ */
	font-weight: bold; /* âœ… ë³¼ë“œ ì ìš© */
	margin-bottom: 10px;
}

#detailContent section p {
	font-size: 1.2rem; /* ê¸°ì¡´ 1.1 â†’ ì¡°ê¸ˆ í‚¤ì›€ */
	font-weight: 500; /* âœ… ì¤‘ê°„ ë³¼ë“œ (ë„ˆë¬´ ë‘ê»ì§€ ì•Šê²Œ) */
	line-height: 1.7;
	margin: 0;
}

#detailContent section img {
	width: 240px;
	height: auto;
	object-fit: cover;
}
</style>
</head>
<body>
	<div th:replace="~{user/fragments/modal :: modalFragment}"></div>
	<div th:replace="~{user/fragments/header :: headerFragment}"></div>
	<div th:replace="~{user/fragments/side-menu :: sideMenuFragment}"></div>

	<div id="container">
		<section>
			<!-- ğŸŸ¢ ìƒë‹¨ ì •ë³´ -->
			<div class="header" style="text-align: center;">
				<h1 th:text="${product.name}"
					style="margin-bottom: 8px; font-size: 2.8rem;">ìƒí’ˆëª…</h1>
				<p th:utext="${product.summary}"
					style="font-size: 1rem; color: #666;">ìƒí’ˆìš”ì•½</p>
			</div>

			<div class="info-box">
				<div class="info-item">
					<span class="info-value red"
						th:text="${#numbers.formatDecimal(product.maxRate,1,'POINT',2,'POINT')} + '%'">2.10%</span>
					<span class="info-label">ìµœê³ ê¸ˆë¦¬</span>
				</div>
				<div class="info-item">
					<span class="info-value"
						th:text="${#numbers.formatDecimal(product.minRate,1,'POINT',2,'POINT')} + '%'">1.80%</span>
					<span class="info-label">ìµœì €ê¸ˆë¦¬</span>
				</div>
				<div class="info-item">
					<span class="info-value" th:text="${product.period} + 'ê°œì›”'">12ê°œì›”</span>
					<span class="info-label">ê°€ì…ê¸°ê°„</span>
				</div>
			</div>

			<!-- ìƒì„¸ ì„¤ëª… ì˜ì—­ (7ê°œ ì„¹ì…˜ í¬í•¨) -->
			<div id="detailContent" th:utext="${product.detail}">ìƒì„¸ ì„¤ëª…</div>

			<!-- ğŸŸ¡ ì„¸ë¶€ ê¸°ëŠ¥ ë²„íŠ¼ (ê³„ì‚°ê¸° ìœ„ë¡œ ì´ë™) -->
			<div
				style="text-align: center; margin-top: 30px; margin-bottom: 10px;">
				<button class="btn" onclick="openModal()">ìƒí’ˆ ì´ìš© ê°€ì´ë“œ</button>
				<button class="btn" onclick="openRateModal()">ê¸ˆë¦¬í‘œ ë³´ê¸°</button>
			</div>

			<div class="calc-container" style="text-align: center;">
				<h3 style="font-size: 1.5rem; margin-bottom: 20px;">ğŸ’° ê°„í¸ ì´ì
					ê³„ì‚°ê¸°</h3>

				<div
					style="display: inline-flex; flex-wrap: wrap; align-items: center; gap: 15px; font-size: 1.2rem; justify-content: center;">
					<label> ì´ ìƒí’ˆì„ <input id="monthsInput" type="text"
						th:value="${product.period}"
						style="width: 60px; padding: 10px; text-align: right; font-size: 1.1rem;" />
						<span>ê°œì›” ê°„</span>
					</label> <label> <input id="depositAmount" type="text"
						value="1,000,000"
						style="width: 170px; padding: 10px; text-align: right; font-size: 1.1rem;" />
						<span>ì›ìœ¼ë¡œ</span>
					</label> <label> ê¸ˆë¦¬ ì—° <input id="rateInput" type="text"
						th:value="${#numbers.formatDecimal(product.maxRate,1,'POINT',2,'POINT')}"
						style="width: 70px; padding: 10px; text-align: right; font-size: 1.1rem;" />
						<span>%ë¥¼ ì ìš©í•˜ë©´?</span>
					</label>
				</div>

				<br>
				<button class="btn" style="margin-top: 20px; background: #F0AD4E;"
					onclick="calcInterest()">âœ” ê²°ê³¼ë³´ê¸°</button>


				<div style="margin-top: 25px; font-size: 1.3rem;">
					ì„¸ì „ ì´ì: <b id="interestResult"
						style="font-size: 1.5rem; color: #1565c0;">0</b> ì›
				</div>
			</div>

			<div style="text-align: center; margin-top: 10px;">
				<a href="/deposit/list" class="btn">ëª©ë¡ìœ¼ë¡œ</a>
			</div>
		</section>
	</div>


	<!-- ëª¨ë‹¬ì°½ -->
	<div id="productModal" class="modal">
		<div class="modal-content" style="position: relative;">
			<span class="close" onclick="closeModal()">&times;</span>
			<h2 style="text-align: center; margin-top: 0;">ìƒí’ˆ ì´ìš© ê°€ì´ë“œ</h2>
			<div th:utext="${modalDetailForModal}" style="margin-bottom: 20px;">ê°€ì´ë“œ
				ë‚´ìš©</div>

			<!-- âœ… í•˜ë‹¨ ë‹«ê¸° ë²„íŠ¼ -->
			<div style="text-align: center;">
				<button class="btn" onclick="closeModal()">ë‹«ê¸°</button>
			</div>
		</div>
	</div>

	<!-- ê¸ˆë¦¬í‘œ ëª¨ë‹¬ -->
	<div id="rateModal" class="modal">
		<div class="modal-content" style="position: relative;">
			<span class="close" onclick="closeRateModal()">&times;</span>
			<h2 style="text-align: center; margin-top: 0;">ê¸ˆë¦¬í‘œ</h2>
			<div th:utext="${modalRateTable}" style="margin-bottom: 20px;">
				<!-- ê¸ˆë¦¬í‘œ HTML ì¶œë ¥ -->
			</div>
			<div style="text-align: center;">
				<button class="btn" onclick="closeRateModal()">ë‹«ê¸°</button>
			</div>
		</div>
	</div>


	<script>
  function openModal() {
    document.getElementById("productModal").style.display = "block";
  }
  function closeModal() {
    document.getElementById("productModal").style.display = "none";
  }
  window.onclick = function(e) {
    if (e.target == document.getElementById("productModal")) {
      closeModal();
    }
  }
  
  function openRateModal() {
	  document.getElementById("rateModal").style.display = "block";
	}
	function closeRateModal() {
	  document.getElementById("rateModal").style.display = "none";
	}
	window.onclick = function(e) {
	  if (e.target === document.getElementById("productModal")) closeModal();
	  if (e.target === document.getElementById("rateModal")) closeRateModal();
	};

  // ì‰¼í‘œ ìë™ ì‚½ì…
 document.getElementById("depositAmount").addEventListener("input", function() {
  const val = this.value.replace(/,/g, '').replace(/\D/g, '');
  this.value = Number(val).toLocaleString();
});

function calcInterest() {
  const amount = Number(document.getElementById("depositAmount").value.replace(/,/g, ''));
  const months = Number(document.getElementById("monthsInput").value);
  const rate = Number(document.getElementById("rateInput").value);

  if (isNaN(amount) || isNaN(months) || isNaN(rate)) {
    alert("ëª¨ë“  ê°’ì„ ìˆ«ìë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
    return;
  }

  const interest = (amount * rate * months) / (12 * 100);
  document.getElementById("interestResult").innerText = Math.floor(interest).toLocaleString();
}


  
  
window.addEventListener("load", () => {
	  const sections = document.querySelectorAll("#detailContent section");

	  sections.forEach((section, i) => {
	    const h2 = section.querySelector("h2");
	    const p = section.querySelector("p");
	    const img = section.querySelector("img");

	    if (h2 && p && img) {
	      const wrapper = document.createElement("div");
	      wrapper.className = "text-wrap";
	      wrapper.appendChild(h2);
	      wrapper.appendChild(p);
	      section.insertBefore(wrapper, img);
	    }

	    // ì§ìˆ˜ë²ˆì§¸ reverse ì ìš©
	    if ([2, 4, 6].includes(i + 1)) {
	      section.classList.add("reverse");
	    }
	  });
	});


</script>
</body>
</html>
