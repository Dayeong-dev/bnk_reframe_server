<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="/css/common.css" />
<link rel="stylesheet" href="/css/user.css" />
<title>BNK ì˜ˆì ê¸ˆ ë©”ì¸</title>
<style>
body {
	background: #f8f9fa;
	font-family: 'BNKGothic', sans-serif;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	align-items: center;
	color: #212529;
}

/* ìŠ¬ë¼ì´ë“œ ë°°ë„ˆ */
.slider-container {
	position: relative;
	width: 100%;
	max-width: 1200px;
	height: 323px; /* âœ… ì—¬ê¸°ê°€ ì¤‘ìš”! */
	overflow: hidden;
	border-radius: 12px;
	margin: 2rem 0;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.slide {
	width: 100%;
	height: 100%;
	object-fit: cover; /* âœ… ë°°ë„ˆ ì˜ì—­ì„ ì±„ì›€, ì˜ë¦¬ëŠ” ê±´ ì–‘ì˜† */
	object-position: center; /* âœ… ì¤‘ì•™ ê¸°ì¤€ìœ¼ë¡œ ìë¦„ */
	display: none;
	border-radius: 12px;
}

.slide.active {
	display: block;
}

.slide img {
	width: 100%;
	height: 100%;
	object-fit: cover;
	border-radius: 12px;
}

.slider-arrow {
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	background: none; /* ë°°ê²½ ì œê±° */
	color: #333;
	font-size: 32px;
	border: none;
	padding: 6px;
	cursor: pointer;
	z-index: 2;
	opacity: 0.7;
	transition: all 0.2s ease;
}

.slider-arrow:hover {
	opacity: 1;
	transform: translateY(-50%) scale(1.2); /* í˜¸ë²„ ì‹œ í™•ëŒ€ íš¨ê³¼ */
}

.slider-arrow.left {
	left: 10px;
}

.slider-arrow.right {
	right: 10px;
}

.dots {
	position: absolute;
	bottom: 5px;
	width: 100%;
	text-align: center;
}

.dot {
	height: 8px;
	width: 8px;
	margin: 0 4px;
	background-color: #ced4da;
	border-radius: 50%;
	display: inline-block;
	cursor: pointer;
}

.dot.active {
	background-color: #fe504f;
}

/* ëª©ì ë³„ ì¶”ì²œ */
.purpose-content-wrapper {
	display: flex;
	width: 100%;
	min-width: 1200px;
	max-width: 1200px;
	gap: 24px;
	height: 330px;
	margin-top: 0.3rem;
}

.sidebar {
	width: 200px;
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.purpose-btn {
	height: 105px;
	display: flex;
	align-items: center;
	justify-content: center;
	background: #fff;
	color: #212529;
	font-weight: bold;
	font-size: 16px;
	cursor: pointer;
	border-radius: 8px;
	transition: background 0.2s;
	position: relative;
	border: 1px solid #ccc;
}

.purpose-btn.active {
	background: #fe504f;
	color: white;
}

.purpose-btn.active::after {
	content: "";
	position: absolute;
	top: 50%;
	right: -10px;
	transform: translateY(-50%);
	border-top: 10px solid transparent;
	border-bottom: 10px solid transparent;
	border-left: 10px solid #fe504f;
}

.recommend-wrapper {
	flex: 1;
	display: flex;
	gap: 16px;
	height: 100%;
}

.highlight-product, .card {
	background: #fff;
	border: 1px solid #ccc;
	border-radius: 10px;
	padding: 1.2rem 1rem; /* âœ… ì—¬ë°± ì‚´ì§ ì¦ê°€ */
	text-align: center;
	cursor: pointer;
	display: flex;
	flex-direction: column;
	justify-content: center;
	font-size: 14px;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
	transition: all 0.2s;
	
}

.highlight-product:hover, .card:hover {
	background: #f8f9fa;
	transform: translateY(-4px);
}

/* âœ… ì œëª© ìŠ¤íƒ€ì¼ ê°œì„  */
.highlight-product h4, .card h4 {
	font-size: 1.2rem;
	font-weight: bold;
	margin-bottom: 0.75rem;
	color: #212529;
}


/* âœ… ì„¤ëª… ìŠ¤íƒ€ì¼ ê°œì„  */
.highlight-product p, .card p {
	font-size: 0.92rem;
	line-height: 1.5;
	margin: 0.2rem 0;
	color: #555;
}


/* âœ… ê¸°ê°„(12ê°œì›” ë“±) ê°•ì¡° (ì„ íƒ) */
.highlight-product p:nth-child(3) {
	color: #fe504f;
}
.card p:last-of-type, .highlight-product p:last-of-type {
	font-weight: bold;
	color: #212529;
	margin-top: 0.5rem;
}

/* ì¹´ë“œ ë°°ì¹˜ */
.grid-cards {
	flex: 1;
	display: grid;
	grid-template-columns: repeat(2, 1fr);
	gap: 10px;
}

/* ê²€ìƒ‰ì°½ */
.search-section {
	width: 100%;
	background: none;
	padding: 2rem 1rem;
	display: flex;
	justify-content: center;
	gap: 1rem;
	flex-wrap: wrap;
}

.search-form {
	display: flex;
	width: 100%;
	max-width: 500px;
	position: relative;
}

.search-input {
	flex: 1;
	padding: 14px 50px 14px 20px;
	border: 1px solid #ccc;
	border-radius: 30px;
	font-size: 15px;
}

.search-icon {
	position: absolute;
	top: 50%;
	right: 18px;
	transform: translateY(-50%);
	background: none;
	border: none;
	cursor: pointer;
	width: 22px;
	height: 22px;
	background-image:
		url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23333' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
	background-repeat: no-repeat;
	background-size: contain;
	background-position: center;
	padding: 0;
}

/* âœ… ìë™ì™„ì„± ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
.autocomplete-box {
	position: absolute;
	top: calc(100% - 1px); /* âœ… ìœ„ìª½ ì„  ê²¹ì¹˜ê²Œ */
	left: 0;
	right: 0;
	background: white;
	border: 1px solid #ccc;
	border-top: none; /* âœ… ìœ„ í…Œë‘ë¦¬ ì•ˆ ë³´ì´ê²Œ */
	border-radius: 0 0 30px 30px;
	box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
	box-sizing: border-box;
	z-index: 999;
}

.autocomplete-box div {
	padding: 12px 18px;
	cursor: pointer;
	font-size: 14px;
	border-bottom: 1px solid #f1f3f5;
}

.autocomplete-box div:last-child {
	border-bottom: none;
}

.autocomplete-box div:hover {
	background: #f1f3f5;
}

.autocomplete-box:empty {
	display: none; /* âœ… ì•„ë¬´ ë‚´ìš© ì—†ìœ¼ë©´ ì•„ì˜ˆ ì•ˆ ë³´ì´ê²Œ */
}

.hashtag-button {
	background: #dee2e6;
	border: none;
	border-radius: 20px;
	padding: 8px 14px;
	font-size: 14px;
	cursor: pointer;
}

.hashtag-button:hover {
	background: #ced4da;
}

/* í…Œë§ˆ ì¶”ì²œ */
.theme-slider-container {
	width: 100%;
	max-width: 1200px;
	margin: 0rem auto;
	position: relative;
}

.theme-btn {
	padding: 10px 20px;
	border: none;
	border-radius: 20px;
	background: #f1f3f5;
	color: #212529;
	font-size: 15px;
	font-weight: 500;
	cursor: pointer;
}

.theme-btn.active-theme {
	background: #fe504f;
	color: white;
}

.theme-card {
	background: white;
	border: 1px solid #dee2e6;
	border-radius: 12px;
	padding: 20px;
	width: 320px;
	height: 240px;
	cursor: pointer;
	text-align: center;
	display: flex;
	flex-direction: column;
	justify-content: center;
	transition: all 0.2s;
}
.theme-card h4{
  	font-size: 1.2rem;
  	margin-bottom: 0.75rem;
}

.theme-card p:nth-child(2) {
	margin-bottom: 1rem;
}

.theme-card:hover {
	transform: translateY(-6px);
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.theme-card .rate {
	color: #fe504f;
	font-weight: bold;
	font-size: 17px;
}

.theme-prev, .theme-next {
	background: white;
	color: #fe504f	;
	border: 2px solid #fe504f;
	width: 40px;
	height: 40px;
	font-size: 20px;
	font-weight: bold;
	border-radius: 50%;
	position: absolute;
	top: 50%;
	transform: translateY(-50%);
	cursor: pointer;
	transition: all 0.3s ease;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
}

.theme-prev:hover, .theme-next:hover {
	background: #fe504f;
	color: white;
}

.theme-prev {
	left: 0px; /* âœ… ë” ì•ˆìª½ìœ¼ë¡œ */
}

.theme-next {
	right: 0px; /* âœ… ë” ì•ˆìª½ìœ¼ë¡œ */
}

.btn {
	display: inline-block;
	background-color: #fe504f;
	color: white;
	padding: 12px 24px;
	border-radius: 30px;
	font-size: 16px;
	font-weight: 500;
	text-decoration: none;
	box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
	transition: background-color 0.2s, transform 0.2s;
}

.btn:hover {
	background-color: #e64945;
	transform: translateY(-2px);
}
</style>
</head>
<body>
	<div th:replace="~{user/fragments/modal :: modalFragment}"></div>
	<div th:replace="~{user/fragments/header :: headerFragment}"></div>
	<div th:replace="~{user/fragments/side-menu :: sideMenuFragment}"></div>

	<div id="container">
		<section>

			<!-- âœ… ìŠ¬ë¼ì´ë“œ ë°°ë„ˆ -->
			<div class="slider-container">
				<div class="slider" id="slider">
					<div class="slide active">
						<img src="/im/069.jpg" alt="ë°°ë„ˆ1" onclick="goToDetail(69, event)">
					</div>
					<div class="slide">
						<img src="/im/070.jpg" alt="ë°°ë„ˆ2" onclick="goToDetail(70, event)">
					</div>
					<div class="slide">
						<img src="/im/073.jpg" alt="ë°°ë„ˆ3" onclick="goToDetail(73, event)">
					</div>
				</div>

				<button class="slider-arrow left" onclick="prevSlide()">â®</button>
				<button class="slider-arrow right" onclick="nextSlide()">â¯</button>
				<div class="dots">
					<span class="dot active" onclick="setSlide(0)"></span> <span
						class="dot" onclick="setSlide(1)"></span> <span class="dot"
						onclick="setSlide(2)"></span>
				</div>
			</div>



			<!-- âœ… ëª©ì ë³„ ì¶”ì²œ ìƒí’ˆ -->
			<div class="purpose-content-wrapper">
				<div class="sidebar">
					<button class="purpose-btn active" data-category="ì ê¸ˆ">ëª©ëˆ
						ë§Œë“¤ê¸°</button>
					<button class="purpose-btn" data-category="ì˜ˆê¸ˆ">ëª©ëˆ êµ´ë¦¬ê¸°</button>
					<button class="purpose-btn" data-category="ì…ì¶œê¸ˆììœ ">ì…ì¶œê¸ˆ ììœ </button>
				</div>

				<div class="recommend-wrapper" id="recommendArea">
					<div th:if="${highlightProduct != null}" class="highlight-product"
						th:onclick="'location.href=\'/deposit/detail/' + ${highlightProduct.productId} + '\''">
						<h4 th:text="${highlightProduct.name}">ê°•ë ¥ì¶”ì²œ</h4>
						<p th:text="${highlightProduct.summary}">ìš”ì•½</p>
						<p>
							ìµœê³  <b th:text="${highlightProduct.maxRate}"></b>% / ìµœì € <b
								th:text="${highlightProduct.minRate}"></b>%
						</p>
						<p>
							<b th:text="${highlightProduct.period}"></b>ê°œì›”
						</p>
					</div>
					<div class="grid-cards">
						<div class="card" th:each="product : ${otherProducts}"
							th:onclick="'location.href=\'/deposit/detail/' + ${product.productId} + '\''">
							<h4 th:text="${product.name}">ì¶”ì²œ ìƒí’ˆëª…</h4>
							<p>
								ìµœê³  <b th:text="${product.maxRate}"></b>% / ìµœì € <b
									th:text="${product.minRate}"></b>%
							</p>
							<p>
								<b th:text="${product.period}"></b>ê°œì›”
							</p>
						</div>
					</div>
				</div>
			</div>

			<!-- âœ… ê²€ìƒ‰ì°½ -->
			<!-- âœ… ê¸°ì¡´ ê²€ìƒ‰ input ì•„ë˜ì— ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ ì¶”ê°€ -->
			<div class="search-section">
				<form class="search-form" action="/deposit/list" method="get">
					<input type="text" name="keyword" id="searchInput"
						class="search-input" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" autocomplete="off">
					<button type="submit" class="search-icon" aria-label="ê²€ìƒ‰"></button>
					<div id="autocompleteList" class="autocomplete-box"></div>
					<!-- ğŸ”¥ ìë™ì™„ì„± ë“œë¡­ë‹¤ìš´ -->
				</form>
				<button class="hashtag-button" onclick="searchHashtag('ì ê¸ˆ')">#ì ê¸ˆ</button>
				<button class="hashtag-button" onclick="searchHashtag('ì˜ˆê¸ˆ')">#ì˜ˆê¸ˆ</button>
			</div>


			<!-- âœ… í…Œë§ˆ ì¶”ì²œ -->
			<div class="theme-slider-container">
				<div
					style="display: flex; justify-content: center; gap: 12px; margin-bottom: 20px;">
					<button class="theme-btn" id="btn-ì£¼ë¶€" onclick="showTheme('ì£¼ë¶€')">ì£¼ë¶€</button>
					<button class="theme-btn active-theme" id="btn-ì§ì¥ì¸"
						onclick="showTheme('ì§ì¥ì¸')">ì§ì¥ì¸</button>
					<button class="theme-btn" id="btn-í•™ìƒ" onclick="showTheme('í•™ìƒ')">í•™ìƒ</button>
				</div>

				<button class="theme-prev" onclick="prevTheme()">â®</button>
				<button class="theme-next" onclick="nextTheme()">â¯</button>

				<div id="themeSlider">
					<div id="theme-ì§ì¥ì¸" class="theme-slide-group"
						style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center;">
						<div th:each="p : ${workerProducts}" class="theme-card"
							th:onclick="'location.href=\'/deposit/detail/' + ${p.productId} + '\''">
							<h4 th:text="${p.name}">ìƒí’ˆëª…</h4>
							<p th:text="${p.summary}">ìƒí’ˆ ìš”ì•½</p>
							<p class="rate" th:text="'ìµœê³  ' + ${p.maxRate} + '%'">ìµœê³  ê¸ˆë¦¬</p>
						</div>
					</div>
					<div id="theme-ì£¼ë¶€" class="theme-slide-group"
						style="display: none; flex-wrap: wrap; gap: 20px; justify-content: center;">
						<div th:each="p : ${housewifeProducts}" class="theme-card"
							th:onclick="'location.href=\'/deposit/detail/' + ${p.productId} + '\''">
							<h4 th:text="${p.name}">ìƒí’ˆëª…</h4>
							<p th:text="${p.summary}">ìƒí’ˆ ìš”ì•½</p>
							<p class="rate" th:text="'ìµœê³  ' + ${p.maxRate} + '%'">ìµœê³  ê¸ˆë¦¬</p>
						</div>
					</div>
					<div id="theme-í•™ìƒ" class="theme-slide-group"
						style="display: none; flex-wrap: wrap; gap: 20px; justify-content: center;">
						<div th:each="p : ${studentProducts}" class="theme-card"
							th:onclick="'location.href=\'/deposit/detail/' + ${p.productId} + '\''">
							<h4 th:text="${p.name}">ìƒí’ˆëª…</h4>
							<p th:text="${p.summary}">ìƒí’ˆ ìš”ì•½</p>
							<p class="rate" th:text="'ìµœê³  ' + ${p.maxRate} + '%'">ìµœê³  ê¸ˆë¦¬</p>
						</div>
					</div>
				</div>
			</div>
		</section>
		
		<div style="text-align: center; margin-top: 10px;">
				<a href="/deposit/list" class="btn">ì „ì²´ ìƒí’ˆ ë³´ëŸ¬ê°€ê¸°</a>
			</div>
		
	</div>

	<script>
    let currentSlide = 0;
    const slides = document.querySelectorAll(".slide");
    const dots = document.querySelectorAll(".dot");

    function showSlide(index) {
      slides.forEach((s, i) => s.classList.toggle("active", i === index));
      dots.forEach((d, i) => d.classList.toggle("active", i === index));
      currentSlide = index;
    }

    function prevSlide() {
      currentSlide = (currentSlide - 1 + slides.length) % slides.length;
      showSlide(currentSlide);
    }

    function nextSlide() {
      currentSlide = (currentSlide + 1) % slides.length;
      showSlide(currentSlide);
    }

    function setSlide(index) {
      showSlide(index);
    }

    setInterval(nextSlide, 4000);
    showSlide(0);

    function goToDetail(id, e) {
    	  if (e) {
    	    e.preventDefault?.();     // ê¸°ë³¸ ë™ì‘ ë°©ì§€
    	    e.stopPropagation?.();    // ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
    	  }
    	  window.location.href = "/deposit/detail/" + id;
    	}


    const themes = ["ì£¼ë¶€", "ì§ì¥ì¸", "í•™ìƒ"];
    let currentThemeIndex = 1;

    function showTheme(theme) {
      themes.forEach(t => {
        const group = document.getElementById("theme-" + t);
        const btn = document.getElementById("btn-" + t);
        if (group && btn) {
          group.style.display = (t === theme ? "flex" : "none");
          btn.classList.toggle("active-theme", t === theme);
        }
      });
      currentThemeIndex = themes.indexOf(theme);
    }

    function prevTheme() {
      currentThemeIndex = (currentThemeIndex - 1 + themes.length) % themes.length;
      showTheme(themes[currentThemeIndex]);
    }

    function nextTheme() {
      currentThemeIndex = (currentThemeIndex + 1) % themes.length;
      showTheme(themes[currentThemeIndex]);
    }

    function searchHashtag(tag) {
      window.location.href = "/deposit/list?keyword=" + encodeURIComponent(tag);
    }

    function selectAutocomplete(word) {
      const input = document.getElementById("searchInput");
      input.value = word;
      document.querySelector(".search-form").submit();
    }

    // âœ… í•˜ë‚˜ë¡œ í†µí•©ëœ DOMContentLoaded
    document.addEventListener("DOMContentLoaded", function () {
      // ì´ˆê¸° í…Œë§ˆ
      showTheme("ì§ì¥ì¸");

      // ëª©ì ë³„ ì¶”ì²œ ë¹„ë™ê¸° ë¡œë”©
      const buttons = document.querySelectorAll(".purpose-btn");
      const recommendArea = document.getElementById("recommendArea");

      buttons.forEach(btn => {
        btn.addEventListener("click", () => {
          const category = btn.dataset.category;
          buttons.forEach(b => b.classList.remove("active"));
          btn.classList.add("active");

          fetch(`/deposit/category?category=${encodeURIComponent(category)}`)
            .then(res => res.json())
            .then(data => updateRecommendation(data))
            .catch(err => console.error("ì¶”ì²œ ìƒí’ˆ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨", err));
        });
      });

      function updateRecommendation(data) {
        let html = "";
        if (data.highlightProduct) {
          const p = data.highlightProduct;
          html += `
            <div class="highlight-product" onclick="location.href='/deposit/detail/${p.productId}'">
              <h4>${p.name}</h4>
              <p>${p.summary}</p>
              <p>ìµœê³  <b>${p.maxRate}</b>% / ìµœì € <b>${p.minRate}</b>%</p>
              <p><b>${p.period}</b>ê°œì›”</p>
            </div>
          `;
        }

        html += `<div class="grid-cards">`;
        data.otherProducts.forEach(p => {
          html += `
            <div class="card" onclick="location.href='/deposit/detail/${p.productId}'">
              <h4>${p.name}</h4>
              <p>ìµœê³  <b>${p.maxRate}</b>% / ìµœì € <b>${p.minRate}</b>%</p>
              <p><b>${p.period}</b>ê°œì›”</p>
            </div>
          `;
        });
        html += `</div>`;

        recommendArea.innerHTML = html;
      }

      const initialCategory = document.querySelector(".purpose-btn.active")?.dataset.category || "ì ê¸ˆ";
      fetch(`/deposit/category?category=${encodeURIComponent(initialCategory)}`)
        .then(res => res.json())
        .then(data => updateRecommendation(data));

      // ìë™ì™„ì„± ê¸°ëŠ¥
      const input = document.getElementById("searchInput");
      const box = document.getElementById("autocompleteList");

      input.addEventListener("keyup", function () {
        const keyword = this.value.trim();
        if (keyword.length < 1) {
          box.innerHTML = "";
          return;
        }

        fetch(`/deposit/autocomplete?keyword=${encodeURIComponent(keyword)}`)
          .then(res => res.json())
          .then(data => {
            if (data.length === 0) {
              box.innerHTML = "";
              return;
            }
            box.innerHTML = data.map(word =>
              `<div onclick="selectAutocomplete('${word}')">${word}</div>`
            ).join("");
          })
          .catch(err => {
            console.error("ìë™ì™„ì„± ì‹¤íŒ¨", err);
            box.innerHTML = "";
          });
      });

      document.addEventListener("click", function (e) {
        if (!input.contains(e.target) && !box.contains(e.target)) {
          box.innerHTML = "";
        }
      });
    });
  </script>
</body>
</html>
