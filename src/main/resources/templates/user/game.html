<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ‰ ë§¥ë¶ ë£°ë › ì´ë²¤íŠ¸ ğŸ‰</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      padding: 30px;
    }

    #wheel-container {
      position: relative;
      width: 300px;
      height: 300px;
      margin: 0 auto;
    }

    /* ğŸ”º ìœ„ì— ê³ ì •ëœ í¬ì¸í„° (ëª¨ì–‘ë§Œ ìœ„ë¡œ ë’¤ì§‘ìŒ) */
  #pointer {
    position: absolute;
    top: -15px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 30px solid orange; /* ğŸ”» ì•„ë˜ë¥¼ í–¥í•˜ê²Œ (í¬ì¸í„° ìœ„ì— ìˆìœ¼ë‹ˆê¹Œ border-top) */
    z-index: 10;
  }

    svg {
      transform: rotate(0deg);
      transition: transform 5s cubic-bezier(0.33, 1, 0.68, 1);
    }

    #spin-btn {
      margin-top: 30px;
      padding: 12px 24px;
      font-size: 16px;
    }

    #macbook-link {
      display: none;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>ğŸ‰ ë§¥ë¶ ë£°ë › ì´ë²¤íŠ¸ ğŸ‰</h1>

  <div id="wheel-container">
    <div id="pointer"></div>
    <svg id="wheel" width="300" height="300" viewBox="0 0 300 300">
      <g transform="translate(150,150)">
        <!-- ë™ì ìœ¼ë¡œ ì¡°ê° ì¶”ê°€ë¨ -->
      </g>
    </svg>
  </div>

  <button id="spin-btn">ë£°ë › ëŒë¦¬ê¸°</button>

  <div id="result" role="alert" aria-live="polite"></div>
  <div id="macbook-link" aria-hidden="true">
    ğŸ‘‰ <a href="https://www.coupang.com/np/search?component=&q=ë§¥ë¶+í”„ë¡œ" target="_blank">ë§¥ë¶ ìµœì €ê°€ ë³´ëŸ¬ê°€ê¸°</a>
  </div>

  <script>
    const sectors = [
      "ê½", "ê½", "ì»¤í”¼ ì¿ í°", "ê½", "ë§¥ë¶ í”„ë¡œ!", "ìŠ¤íƒ€ë²…ìŠ¤ ì¿ í°", "ê½", "ê½"
    ];
    const colors = ["#28a745", "#218838"];
    const sectorAngle = 360 / sectors.length;
    const svg = document.querySelector("#wheel g");
    const wheel = document.getElementById('wheel');
    const btn = document.getElementById('spin-btn');
    const result = document.getElementById('result');
    const macbookLink = document.getElementById('macbook-link');
    const STORAGE_KEY = 'rouletteSpunDate';
    let currentRotation = 0;

    // SVG pie sectors + label
    sectors.forEach((label, i) => {
      const startAngle = i * sectorAngle;
      const endAngle = (i + 1) * sectorAngle;
      const largeArc = sectorAngle > 180 ? 1 : 0;
      const r = 150;

      const x1 = r * Math.cos((startAngle - 90) * Math.PI / 180);
      const y1 = r * Math.sin((startAngle - 90) * Math.PI / 180);
      const x2 = r * Math.cos((endAngle - 90) * Math.PI / 180);
      const y2 = r * Math.sin((endAngle - 90) * Math.PI / 180);

      const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
      const d = `M0 0 L${x1} ${y1} A${r} ${r} 0 ${largeArc} 1 ${x2} ${y2} Z`;
      path.setAttribute("d", d);
      path.setAttribute("fill", colors[i % colors.length]);
      svg.appendChild(path);

      // ê¸€ì ìœ„ì¹˜: ì¤‘ì‹¬ì—ì„œ ë°˜ì§€ë¦„ì˜ ì•½ 65% ìœ„ì¹˜ì— ë°°ì¹˜ (ì ë‹¹íˆ ë°”ê¹¥ìª½)
      const radiusForText = 110; // ì¤‘ì‹¬ì—ì„œ ì‚´ì§ ë°”ê¹¥
      const angle = startAngle + sectorAngle / 2;
      const angleRad = angle * Math.PI / 180;

      const textX = radiusForText * Math.cos(angleRad);
      const textY = radiusForText * Math.sin(angleRad);

      const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
      text.setAttribute("x", textX);
      text.setAttribute("y", textY);
      text.setAttribute("fill", "#fff");
      text.setAttribute("font-size", "14");
      text.setAttribute("font-weight", "bold");
      text.setAttribute("text-anchor", "middle");
      text.setAttribute("alignment-baseline", "middle");
      text.textContent = label;

      // ğŸ”„ íšŒì „ ì œê±°! í…ìŠ¤íŠ¸ëŠ” í•­ìƒ ìˆ˜í‰ ë°©í–¥
      svg.appendChild(text);



    });

    function hasSpunToday() {
      const lastSpin = localStorage.getItem(STORAGE_KEY);
      if (!lastSpin) return false;
      return new Date(lastSpin).toDateString() === new Date().toDateString();
    }

    function setSpunToday() {
      localStorage.setItem(STORAGE_KEY, new Date().toISOString());
    }

    function spin() {
      if (hasSpunToday()) {
        alert('í•˜ë£¨ì— í•œ ë²ˆë§Œ ì°¸ì—¬í•  ìˆ˜ ìˆì–´ìš”!');
        return;
      }
      btn.disabled = true;
      result.textContent = 'ëŒë¦¬ëŠ” ì¤‘...';
      macbookLink.style.display = 'none';

      const targetIndex = Math.floor(Math.random() * sectors.length);
      const spins = 360 * 5 + (360 - (targetIndex * sectorAngle + sectorAngle / 2));
      currentRotation += spins;

      wheel.style.transition = 'transform 5s cubic-bezier(0.33, 1, 0.68, 1)';
      wheel.style.transform = `rotate(${currentRotation}deg)`;

      wheel.addEventListener('transitionend', function onEnd() {
        wheel.removeEventListener('transitionend', onEnd);
        result.textContent = `ğŸ‰ ê²°ê³¼: ${sectors[targetIndex]} ë‹¹ì²¨!`;
        if (sectors[targetIndex] === 'ë§¥ë¶ í”„ë¡œ!') {
          macbookLink.style.display = 'block';
        }
        setSpunToday();
      });
    }

    if (hasSpunToday()) {
      btn.disabled = true;
      result.textContent = 'ì˜¤ëŠ˜ ì´ë¯¸ ë£°ë ›ì„ ëŒë¦¬ì…¨ìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ë„ì „í•˜ì„¸ìš”!';
      macbookLink.style.display = 'block';
    }

    btn.addEventListener('click', spin);
  </script>
</body>
</html>
